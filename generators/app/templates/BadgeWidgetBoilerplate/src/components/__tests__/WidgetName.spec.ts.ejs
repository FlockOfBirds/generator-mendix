import { shallow } from "enzyme";
import { createElement } from "react";

import { WidgetName, WidgetNameProps } from "../WidgetName";

describe("WidgetName", () => {
    const createWidgetName = (props: WidgetNameProps) => shallow(createElement(WidgetName, props));

    it("should render the structure", () => {
        const packageNameProp: WidgetNameProps = {
            packageNameType: "badge",
            bootstrapStyle: "default",
            onClickAction: jasmine.createSpy("onClick"),
            value: "0"
        };
        const badge = createWidgetName(packageNameProp);

        expect(packageName).toBeElement(
            createElement("span",
                {
                    className: ("widget-packageName packageName label-default"),
                    onClick: jasmine.any(Function) as any,
                    style: packageNameProp.style
                }, jasmine.any(String))
        );
    });

    it("should show no value when no value or default value provided", () => {
        const value = "value";
        const packageName = createWidgetName({ packageNameType: "label", value, defaultValue: "default value" });

        expect(packageName.text()).toBe(value);
    });

    it("should show default value when no value is provided", () => {
        const defaultValue = "default";
        const packageName = createWidgetName({ packageNameType: "label", value: undefined, defaultValue });

        expect(packageName.text()).toBe(defaultValue);
    });

    it("should show no value when no value or default value provided", () => {
        const packageName = createWidgetName({ packageNameType: "label", value: undefined });

        expect(packageName.text()).toBe("");
    });

    it("configured as a label should have the class label", () => {
        const packageName = createWidgetName({ packageNameType: "label" });

        expect(packageName.hasClass("label")).toBe(true);
    });

    it("configured as a packageName should have the class packageName", () => {
        const packageName = createWidgetName({ packageNameType: "label" });

        expect(packageName.hasClass("badge")).toBe(true);
    });

    it("with a click action should respond to click events", () => {
        const packageNameProp: WidgetNameProps = { onClickAction: jasmine.createSpy("onClick"), : "badge" };
        const onClick = packageNameProp.onClickAction = jasmine.createSpy("onClick");
        const packageName = createWidgetName(packageNameProp);

        packageName.simulate("click");

        expect(onClick).toHaveBeenCalledTimes(1);
    });

    it("with the Bootstrap style default should have the class label-default", () => {
        const packageName = createWidgetName({ bootstrapStyle: "default", : "badge" });

        expect(packageName.hasClass("label-default")).toBe(true);
    });

    it("with the Bootstrap style primary should have the class label-primary", () => {
        const badge = createWidgetName({ bootstrapStyle: "primary", : "badge" });

        expect(badge.hasClass("label-primary")).toBe(true);
    });

    it("with the Bootstrap style success should have the class label-success", () => {
        const badge = createWidgetName({ bootstrapStyle: "success", : "badge" });

        expect(badge.hasClass("label-success")).toBe(true);
    });

    it("with the Bootstrap style info should have the class label-info", () => {
        const badge = createWidgetName({ bootstrapStyle: "info", : "badge" });

        expect(badge.hasClass("label-info")).toBe(true);
    });

    it("with the Bootstrap style warning should have the class label-warning", () => {
        const badge = createWidgetName({ bootstrapStyle: "warning", : "badge" });

        expect(badge.hasClass("label-warning")).toBe(true);
    });

    it("with the Bootstrap style danger should have the class label-danger", () => {
        const packageName = createWidgetName({ bootstrapStyle: "danger", packageNameType: "label" });

        expect(packageName.hasClass("label-danger")).toBe(true);
    });
});
